<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<title>Lab6 Pokemon Animation</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: linear-gradient(#6ec6ff, #bde7ff);
  }

  /* ХМАРИ */
  .clouds {
    position: absolute;
    top: 0;
    left: 0;
    width: 200%;
    height: 40vh;
    background: url('https://i.imgur.com/iy5Yd6A.png') repeat-x;
    background-size: contain;
    animation: cloudsMove 40s linear infinite;
    pointer-events: none;
  }

  @keyframes cloudsMove {
    from { transform: translateX(0); }
    to   { transform: translateX(-50%); }
  }

  /* ТРАВА */
  .grass {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 200%;
    height: 30vh;
    background: url('https://i.imgur.com/5C9zQhP.png') repeat-x;
    background-size: contain;
    animation: grassIdle 6s linear infinite;
  }

  @keyframes grassIdle {
    0% { transform: translateX(0); }
    100% { transform: translateX(-20px); }
  }

  .grass.run {
    animation: grassRun 0.3s linear infinite;
  }

  @keyframes grassRun {
    from { transform: translateX(0); }
    to   { transform: translateX(-50px); }
  }

  /* ПІКАЧУ (спрайт з pokemondb) */
  .pikachu {
    position: absolute;
    bottom: 18vh;
    left: 50px;
    width: 96px;
    height: 96px;
    background: url('https://i.imgur.com/dqQX1Qp.png'); /* sprite */
    image-rendering: pixelated;
    animation: idle 0.7s steps(2) infinite;
  }

  /* Idle анімація */
  @keyframes idle {
    from { background-position: 0 0; }
    to   { background-position: -192px 0; }
  }

  /* Анімація бігу */
  @keyframes run {
    from { background-position: 0 -96px; }
    to   { background-position: -384px -96px; }
  }

  /* Анімація стрибка */
  @keyframes jumpAnim {
    0% { bottom: 18vh; }
    40% { bottom: 32vh; }
    100% { bottom: 18vh; }
  }
</style>
</head>
<body>

<div class="clouds"></div>
<div class="grass" id="grass"></div>
<div class="pikachu" id="pk"></div>

<script>
const pk = document.getElementById("pk");
const grass = document.getElementById("grass");
let x = 50;
let speed = 8;
let isJumping = false;
let isRunning = false;

function move() {
  pk.style.left = x + "px";
}

// КЕРУВАННЯ
window.addEventListener("keydown", e => {
  if (e.code === "ArrowRight") {
    x += speed;
    pk.style.transform = "scaleX(1)";
    pk.style.animation = "run 0.4s steps(4) infinite";
    grass.classList.add("run");
    isRunning = true;
  }

  if (e.code === "ArrowLeft") {
    x -= speed;
    pk.style.transform = "scaleX(-1)";
    pk.style.animation = "run 0.4s steps(4) infinite";
    grass.classList.add("run");
    isRunning = true;
  }

  if (e.code === "Space" && !isJumping) {
    isJumping = true;
    pk.style.animation = "jumpAnim 0.6s ease, idle 0.7s steps(2) infinite 0.6s";

    setTimeout(() => {
      isJumping = false;
      pk.style.animation = isRunning ? "run 0.4s steps(4) infinite" : "idle 0.7s steps(2) infinite";
    }, 600);
  }
  move();
});

window.addEventListener("keyup", e => {
  if (e.code === "ArrowRight" || e.code === "ArrowLeft") {
    isRunning = false;
    grass.classList.remove("run");
    if (!isJumping) pk.style.animation = "idle 0.7s steps(2) infinite";
  }
});
</script>

</body>
</html>
